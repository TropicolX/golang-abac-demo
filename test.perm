entity user {}

entity document {
	relation owner @user
	attribute classification string
  attribute department string
    
	permission view = is_public(classification) or (is_internal(classification) and in_same_department(department, request.dept)) or (is_confidential(classification) and owner)
	permission edit = owner or (is_internal(classification) and in_same_department(department, request.dept))
	permission delete = owner
}

rule is_public(classification string) {
	classification == 'public'
}

rule is_internal(classification string) {
	classification == 'internal'
}

rule is_confidential(classification string) {
	classification == 'confidential'
}

rule in_same_department(department string, dept string) {
	department == dept
}

